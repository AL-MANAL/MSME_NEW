@using System.Data;
@{
    Layout = "~/Views/Shared/_PrintLayout.cshtml";
    ViewBag.Title = "KPI Report";
    
    DataSet dsKPI=new DataSet();
    
    if(ViewBag.dsKPIList != null)
    {
        dsKPI=ViewBag.dsKPIList;
    }

    string fromdateValue = DateTime.Now.AddMonths(-1).ToString("yyyy-MM-dd"), toDateValue = DateTime.Now.ToString("yyyy-MM-dd");
    if (ViewBag.fromdateValue != null)
    {
        fromdateValue = ViewBag.fromdateValue;
    }

    if (ViewBag.toDateValue != null)
    {
        toDateValue = ViewBag.toDateValue;
    }
    
}


<div class="card">

 	   <div class="card-header header-elements-inline bg-primary">
                <h5 class="card-title">KPI Report</h5>
       </div>
 	 
 	   <div class="card-body">
 @if (dsKPI != null && dsKPI.Tables.Count > 0 && dsKPI.Tables[0].Rows.Count > 0)
    {
 <div class="card">
                <table>
                    <tr>
                        <td>
                            <div id="logo" style="padding-left: 30px;">
                                <img src="@Url.Content(dsKPI.Tables[0].Rows[0]["logo"].ToString())" style="width: 150px;height: 100px;" />
                            </div>
                        </td>
                        <td style="text-align: center; font-weight: bold; width: 80%; font-size: 16px;">
                            <span>@dsKPI.Tables[0].Rows[0]["CompanyName"].ToString()</span>
                            <br />
                            <span>KPI REPORT</span>
                        </td>
                    </tr>
                </table>
 </div>
  <div>
                <table class="table table-lg table-bordered">
                    <thead>
                      
                    <tr class="bg-blue font-weight-bold">
                <th>Sl No</th>
                <th>KPI Ref</th>
                <th>Person Responsible‎</th>
                <th>Freq of Eval</th>               
                <th>Dept Name‎‎</th>               
                <th>Established On‎‎</th>
                <th>Process Indicator</th>
                <th>Measurable Value</th>
                <th>Monitoring Mechanism</th>
                <th>Measured Value</th>     
                <th>Evaluation Status‎‎</th>
                <th>Evaluated On</th>
                <th>NCRRef</th>             
                    </tr>
                    </thead>

                    @for (int i = 0, j = 1; i < dsKPI.Tables[0].Rows.Count; i++, j++)
                    {
                      <tbody>
                        <tr>
                            <td>@j</td>
            
                <td>@dsKPI.Tables[0].Rows[i]["KPI_Ref"].ToString()</td>
                <td>@dsKPI.Tables[0].Rows[i]["Person_Responsible"].ToString()</td>             
                <td>@dsKPI.Tables[0].Rows[i]["Freq_of_Eval"].ToString()</td>
                <td>@dsKPI.Tables[0].Rows[i]["DeptName"].ToString()</td>
                              <td>
                     @if (dsKPI.Tables[0].Rows[i]["EstablishedOn"].ToString() != "" && dsKPI.Tables[0].Rows[i]["EstablishedOn"].ToString() != null)
                         {
                         @Convert.ToDateTime(dsKPI.Tables[0].Rows[i]["EstablishedOn"].ToString()).ToString("dd/MM/yyyy")
                         }
                 </td>   
                <td>@dsKPI.Tables[0].Rows[i]["Process_Indicator"].ToString()</td>
                <td>@dsKPI.Tables[0].Rows[i]["Measurable_Value"].ToString()</td>
                <td>@dsKPI.Tables[0].Rows[i]["Monitoring_Mechanism"].ToString()</td>
                <td>@dsKPI.Tables[0].Rows[i]["Measured_Value"].ToString()</td>
                <td>@dsKPI.Tables[0].Rows[i]["Eval_Status"].ToString()</td>
               <td>
                     @if (dsKPI.Tables[0].Rows[i]["Eval_On"].ToString() != "" && dsKPI.Tables[0].Rows[i]["Eval_On"].ToString() != null)
                         {
                         @Convert.ToDateTime(dsKPI.Tables[0].Rows[i]["Eval_On"].ToString()).ToString("dd/MM/yyyy")
                         }
                 </td>       
                <td>@dsKPI.Tables[0].Rows[i]["NCRRef"].ToString()</td>
                @*<td>@dsKPI.Tables[0].Rows[i]["Approved_Status"].ToString()</td>*@

                        </tr>
                          </tbody>
                    }
                </table>
              </div>
}
	   </div>
</div>
    

@section Scripts {
    <script>
      
    </script>
}
